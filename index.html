<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>NAFIX</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background-color: #1a1a1a;
      color: #fff;
      font-family: monospace;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 { margin-top: 20px; color: #00ffdd; text-shadow: 2px 2px 4px #000; }
    #ui { display: flex; gap: 20px; margin: 10px; }
    #score, #lives {
      font-size: 20px;
      background: #333;
      padding: 5px 10px;
      border: 2px solid #00ffdd;
      border-radius: 5px;
    }
    canvas {
      background: #000;
      border: 2px solid #00ffdd;
      box-shadow: 0 0 15px #00ffdd;
    }
    #controls { margin: 10px; text-align: center; }
    #menu {
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0,0,0,0.9);
      border: 2px solid #00ffdd;
      padding: 20px;
      text-align: center;
      display: none;
    }
    #menu button {
      padding: 10px 20px;
      margin: 10px;
      background: #00ffdd;
      border: none;
      cursor: pointer;
      font-size: 16px;
      color: #000;
    }
    #menu button:hover { background: #00cccc; }
  </style>
</head>
<body>
  <h1>NAFIX</h1>
  <div id="ui">
    <div id="score">Puntaje: 0</div>
    <div id="lives">Vidas: 3</div>
  </div>
  <canvas id="gameCanvas" width="800" height="600"></canvas>
  <div id="controls">
    <p>Movimiento: <strong>W A S D</strong></p>
    <p>Disparar: <strong>Barra espaciadora</strong></p>
    <p>Pausar/Reanudar: <strong>P</strong></p>
  </div>
  <div id="menu">
    <h2 id="menuTitle">Pausa</h2>
    <button id="resumeBtn" onclick="resumeGame()">Reanudar</button>
    <button onclick="resetGame()">Reiniciar</button>
  </div>
<script>
  const canvas = document.getElementById('gameCanvas'), ctx = canvas.getContext('2d');
  const scoreDisplay = document.getElementById('score'), livesDisplay = document.getElementById('lives');
  const menu = document.getElementById('menu'), menuTitle = document.getElementById('menuTitle');
  const resumeBtn = document.getElementById('resumeBtn');

  let score = 0, lives = 3, paused = false, gameOver = false, gameWon = false;
  const MAX_SCORE = 10000;

  const player = { x: canvas.width/2 - 25, y: canvas.height - 60, width: 50, height: 50, color: '#00ffdd', speed: 5 };
  const bullets = [], enemies = [];
  const bulletSpeed = 7, enemySpeed = 1.2;
  const keys = { w: false, a: false, s: false, d: false };

  function drawRect(obj) { ctx.fillStyle = obj.color; ctx.fillRect(obj.x, obj.y, obj.width, obj.height); }
  function clearScreen() { ctx.clearRect(0, 0, canvas.width, canvas.height); }

  function update() {
    if (paused || gameOver || gameWon) return;

    if (keys.a && player.x > 0) player.x -= player.speed;
    if (keys.d && player.x + player.width < canvas.width) player.x += player.speed;
    if (keys.w && player.y > 0) player.y -= player.speed;
    if (keys.s && player.y + player.height < canvas.height) player.y += player.speed;

    bullets.forEach((b, i) => { b.y -= bulletSpeed; if (b.y < 0) bullets.splice(i, 1); });

    if (enemies.length < 10 && Math.random() < 0.01) {
      enemies.push({ x: Math.random()*(canvas.width-30), y: -30, width: 30, height: 30, color: '#ff3333' });
    }

    enemies.forEach((e, i) => {
      e.y += enemySpeed;
      if (e.y > canvas.height) {
        enemies.splice(i, 1);
        lives--; updateLives();
        if (lives <= 0) endGame();
      }
    });

    bullets.forEach((b, bi) => enemies.forEach((e, ei) => {
      if (b.x < e.x+e.width && b.x+b.width > e.x && b.y < e.y+e.height && b.y+b.height > e.y) {
        bullets.splice(bi, 1); enemies.splice(ei, 1);
        score += 10;
        if (score >= MAX_SCORE) winGame();
        scoreDisplay.textContent = `Puntaje: ${score}`;
      }
    }));

    enemies.forEach((e, ei) => {
      if (
        player.x < e.x+e.width &&
        player.x+player.width > e.x &&
        player.y < e.y+e.height &&
        player.y+player.height > e.y
      ) {
        enemies.splice(ei, 1);
        lives--; updateLives();
        if (lives <= 0) endGame();
      }
    });
  }

  function draw() {
    clearScreen();
    drawRect(player);
    bullets.forEach(b => drawRect({...b, color:'#ff00ff'}));
    enemies.forEach(e => drawRect(e));
  }

  function gameLoop() {
    update(); draw();
    requestAnimationFrame(gameLoop);
  }

  function togglePause() {
    if (gameOver || gameWon) return;
    paused = !paused;
    menu.style.display = paused ? 'block' : 'none';
    menuTitle.textContent = paused ? 'Pausa' : '';
    resumeBtn.style.display = paused ? 'inline-block' : 'none';
  }

  function resumeGame() {
    paused = false;
    menu.style.display = 'none';
  }

  function resetGame() {
    score = 0; lives = 3; paused = false; gameOver = false; gameWon = false;
    scoreDisplay.textContent = `Puntaje: ${score}`;
    updateLives();
    enemies.length = bullets.length = 0;
    menu.style.display = 'none';
  }

  function endGame() {
    gameOver = true;
    menu.style.display = 'block';
    menuTitle.textContent = '¡Game Over!';
    resumeBtn.style.display = 'none';
  }

  function winGame() {
    gameWon = true;
    menu.style.display = 'block';
    menuTitle.textContent = '¡Has pasado el juego!<br>Espera más actualizaciones.';
    resumeBtn.style.display = 'none';
  }

  function updateLives() {
    livesDisplay.textContent = `Vidas: ${lives}`;
  }

  document.addEventListener('keydown', e => {
    if (e.key.toLowerCase() in keys) keys[e.key.toLowerCase()] = true;
    if (e.code === 'Space' && !paused && !gameOver && !gameWon) {
      bullets.push({ x: player.x + player.width/2 - 2.5, y: player.y, width: 5, height: 10 });
    }
    if (e.key.toLowerCase() === 'p') togglePause();
  });

  document.addEventListener('keyup', e => {
    if (e.key.toLowerCase() in keys) keys[e.key.toLowerCase()] = false;
  });

  gameLoop();
</script>
</body>
</html>
